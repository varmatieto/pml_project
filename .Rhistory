setwd("~/GitHub/pml_project")
setwd("~/GitHub/pml_project")
library(caret, quietly=TRUE)
url_train <- 'https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv'
url_test <- 'https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv'
if (!file.exists('data/data_train.csv')) {
download.file(url = url_train, destfile = 'data_train.csv')
}
if (!file.exists('data/data_test.csv')) {
download.file(url = url_test, destfile = 'data_test.csv')
}
pml_train <- read.csv(file = 'data/data_train.csv',
na.strings = c('NA','#DIV/0!',''))
pml_submit <- read.csv(file = 'data/data_test.csv',
na.strings = c('NA','#DIV/0!',''))
# str(pml_submit)
# str(pml_train)
dim(pml_submit)
dim(pml_train)
# colnames are identical except "problem_id" and "classe"
ct<-colnames(pml_submit)
cd<-colnames(pml_train)
ct[!(ct%in%cd)]
cd[!(cd%in%ct)]
# there are several variables full of NA
colna<-colSums(is.na(pml_submit))
hist(colna)
colna0<-colSums(is.na(pml_submit)) == 0
colna20<-colSums(is.na(pml_submit)) == 20
table(colna0)
table(colna20)
colnames(pml_submit)[colna0]
features <- colnames(pml_submit[colna0])[8:59]
data <- pml_train[,c(features,"classe")]
submit <- pml_submit[,c(features,"problem_id")]
dim(data)
dim(submit)
plot(data$classe,col=rainbow(5),main = "`classe` frequency plot")
set.seed(2204)
inTrain = createDataPartition(data$classe, p = 0.75, list = F)
training = data[inTrain,]
testing = data[-inTrain,]
dim(training)
dim(testing)
colnat<-colSums(is.na(pml_train))
hist(colnat)
